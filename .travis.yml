language: php
php:
  - 7.2
  - 7.1
  - 7.0

dist: xenial

matrix:
  fast_finish: true
  allow_failures:

cache:
  directories:
    - $HOME/.composer/cache

before_script:
  - "if [ `php -r 'echo (PHP_VERSION_ID < 70100 ? 0 : 1);'` -eq '1' ]; then
       echo 'new';
       composer install --verbose;
     else
       echo 'old';
       composer remove --no-update --verbose --dev friendsofphp/php-cs-fixer;
       composer remove --no-update --verbose --dev phpro/grumphp;
       composer require --no-update --verbose --dev 'phpunit/phpunit':'^6';
       composer update --verbose --with-dependencies friendsofphp/php-cs-fixer phpro/grumphp phpunit/phpunit;
     fi"

script: vendor/bin/phpunit
